<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org">
  	<head>
		<title>La Sofia</title> 
		<link rel="stylesheet" th:href="@{/css/style.css}" /> 
		<script type="text/javascript" th:src="@{/js/index.js}"></script>
		<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
	</head>
	<body>
		<div class="menu-container">
			<div th:replace="~{home :: header}"></div>
			<div class="menu-img-container">
				<div th:text="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')} ? '' : 'Menu'" class="menuText"></div>
				<div class="menu-img"></div>
			</div>
			<div class="grid">
				<div th:if="not ${salad.isEmpty()}" class="dish-group" id="salads"> 
					<div  class="group-name">Salads</div>
					<table>
						<th:block th:each="dish : ${salad}">
						    <tr>
						        <td>
									<div class="dish-name" th:text="${dish.name}">dishName</div>
									<span class="dish-decriprion">
										<span th:text="${dish.structure}">dishStruct</span>/ 
										<span th:text="${dish.kcal}">dishKcal</span> kcal/
										<span th:text="${dish.weight}">dishWeight</span> g
									</span>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDish}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Username" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
				<div  th:if="not ${soup.isEmpty()}" class="dish-group" id="soups"> 
					<div class="group-name">Soups</div>
					<table>
						<th:block th:each="dish : ${soup}">
						    <tr>
						        <td>
									<div class="dish-name" th:text="${dish.name}">dishName</div>
									<span class="dish-decriprion">
										<span th:text="${dish.structure}">dishStruct</span>/ 
										<span th:text="${dish.kcal}">dishKcal</span> kcal/
										<span th:text="${dish.weight}">dishWeight</span> g
									</span>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDish}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Username" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
				<div th:if="not ${hot_dish.isEmpty()}" class="dish-group" id="hotDishes"> 
					<div class="group-name">Hot dishes</div>
					<table>
						<th:block th:each="dish : ${hot_dish}">
						    <tr>
						        <td class="td">
									<div class="dish-name" th:text="${dish.name}">dishName</div>
									<span class="dish-decriprion">
										<span th:text="${dish.structure}">dishStruct</span>/ 
										<span th:text="${dish.kcal}">dishKcal</span> kcal/
										<span th:text="${dish.weight}">dishWeight</span> g
									</span>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDish}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Username" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
				<div th:if="not ${cold_dish.isEmpty()}" class="dish-group" id="coldDishes"> 
					<div class="group-name">Cold dishes</div>
					<table>
						<th:block th:each="dish : ${cold_dish}">
						    <tr>
						        <td class="td">
									<div class="dish-name" th:text="${dish.name}">dishName</div>
									<span class="dish-decriprion">
										<span th:text="${dish.structure}">dishStruct</span>/ 
										<span th:text="${dish.kcal}">dishKcal</span> kcal/
										<span th:text="${dish.weight}">dishWeight</span> g
									</span>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDish}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Username" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
				<div th:if="not ${snacks.isEmpty()}" class="dish-group" id="snacks"> 
					<div class="group-name">Snacks</div>
					<table>
						<th:block th:each="dish : ${snacks}">
						    <tr>
						        <td class="td">
									<div class="dish-name" th:text="${dish.name}">dishName</div>
									<span class="dish-decriprion">
										<span th:text="${dish.structure}">dishStruct</span>/ 
										<span th:text="${dish.kcal}">dishKcal</span> kcal/
										<span th:text="${dish.weight}">dishWeight</span> g
									</span>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDish}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Username" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
				<div th:if="not ${dessert.isEmpty()}" class="dish-group" id="desserts"> 
					<div class="group-name">Dessert</div>
					<table>
						<th:block th:each="dish : ${dessert}">
						    <tr>
						        <td class="td">
									<div class="dish-name" th:text="${dish.name}">dishName</div>
									<span class="dish-decriprion">
										<span th:text="${dish.structure}">dishStruct</span>/ 
										<span th:text="${dish.kcal}">dishKcal</span> kcal/
										<span th:text="${dish.weight}">dishWeight</span> g
									</span>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDish}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Username" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
				<div th:if="not ${drinks.isEmpty()}" class="dish-group" id="drinks"> 
					<div class="group-name">Drinks</div>
					<table>
						<th:block th:each="dish : ${drinks}">
						    <tr>
						        <td>
									<div class="dish-name" th:text="${dish.name}">drinkName</div>
								</td> 
						       	<td th:text="${dish.price}">dishPrice</td>
						       	<td th:if="${user} and ${user.getAuthorities().toString().equals('[ROLE_CLIENT]')}" style="padding: 1px;">
									<form  method="get" th:action="@{/order/addDrink}">
										<div class="add-container">
											<input type="number" min="1" value="1" th:name="count" placeholder="Count" required="true" />
											<input type="hidden" th:name="id" th:value="${dish.id}"/>
											<input type="submit" value="Add">
										</div>
									</form>  
								</td>
						    </tr>
						</th:block>
					</table>
				</div>
			</div> 
			<div th:if="${order} and ${order.deliveryCost!=0}" class="order-container">
				<div class="order-name">My Order</div>
				<ul class="order-list">
					<li th:each="counter : ${order.orderDishCounteres}">
						<div class="dish-name" th:text="${counter.dish.name}"></div>
						<div class="dish-count" th:text="'x'+${counter.count}"></div>
						<div class="dish-price" th:text="${@thymeMath.ceil(counter.count*counter.dish.price)}+' BYN'"></div>
						<div class="dish-delete">
							<a th:href="@{/order/deleteDish(id=${counter.dish.id})}">Delete</a>
						</div>
					</li>
					<li th:each="counter : ${order.orderDrinkCounteres}">
						<div class="dish-name" th:text="${counter.drink.name}"></div>
						<div class="dish-count" th:text="'x'+${counter.count}"></div>
						<div class="dish-price" th:text="${@thymeMath.ceil(counter.count*counter.drink.price)}+' BYN'"></div>
						<div class="dish-delete">
							<a th:href="@{/order/deleteDrink(id=${counter.drink.id})}">Delete</a>
						</div>
					</li>
				</ul>
				<div class="cost-container">	
					<div class="cost-name">Total cost: </div>
					<div class="total-cost" th:text="${order.deliveryCost}+' BYN'"></div>
				</div>
				<div class="order-form-container">
					<div class="order-name">Order details</div>
					<div class="order-form">
						<form method="POST" th:action="@{/order/confirm}" th:object="${order}"> 
							<input type="text" name="deliveryStreet" placeholder="Street" id="deliveryStreet" th:field="*{deliveryStreet}" required="true"/><br/>
							<div class="alert"
								th:if="${#fields.hasErrors('deliveryStreet')}" 
								th:errors="*{deliveryStreet}">street Error</div> 
							<input type="text" name="deliveryHouse" placeholder="House" id="deliveryHouse" th:field="*{deliveryHouse}" required="true"/><br/>
							<div class="alert"
								th:if="${#fields.hasErrors('deliveryHouse')}" 
								th:errors="*{deliveryHouse}">deliveryHouse Error</div>
							<input type="number" min="1" name="deliveryApartment" placeholder="Apartment" id="deliveryApartment" th:field="*{deliveryApartment}" required="true"/><br/>
							<div class="alert"
								th:if="${#fields.hasErrors('deliveryApartment')}" 
								th:errors="*{deliveryApartment}">deliveryApartment Error</div>
							<input type="date" name="deliveryDate" placeholder="Date" id="deliveryDate" th:field="*{deliveryDate}" required="true"/><br/>
							<div class="alert"
								th:if="${#fields.hasErrors('deliveryDate')}" 
								th:errors="*{deliveryDate}">deliveryDate Error</div>
							<input type="time" name="deliveryTime" placeholder="Time" id="deliveryTime" th:field="*{deliveryTime}" required="true"/><br/>
							<div class="alert"
								th:if="${#fields.hasErrors('deliveryTime')}" 
								th:errors="*{deliveryTime}">deliveryTime Error</div>
							<div class="alert" 
								th:if="${errorMessage}"
								th:text="${errorMessage}">
					        		errorText</div>
							<input class="comment" type="text" name="deliveryComment" placeholder="Comment" id="deliveryComment" th:field="*{deliveryComment}"/><br/>
							<input type="hidden" name="deliveryCost" placeholder="Cost" id="deliveryCost" th:field="*{deliveryCost}" required="true"/>
							<div class="cost-container">	
								<div class="cost-name">Total cost: </div>
								<div class="total-cost" th:text="${order.deliveryCost}+' BYN'"></div>		
							</div>
							<div class="btn">
								<input type="submit" value="Confirm"/>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</body>
	<footer>
		<div th:replace="~{home :: footer}"></div>
	</footer>
</html>